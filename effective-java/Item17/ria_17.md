### 변경 가능성을 최소화하라

#### 불변 클래스

- 그 인스턴스의 내부 값을 수정할 수 없는 클래스
- ex) String, Wapper Class, BigInteger, BigDecimal
- 설계 및 구현이 용이하다.
- 오류 여지가 적고 안전하다.

#### 불변 클래스 5가지 규칙

1. 객체의 상태를 변경하는 메서드(변경자)를 제공하지 않는다.
   - setter()
2. 클래스를 확장할 수 없도록 한다.
   - extends X
   - 모든 생성자를 private 혹은 package-private으로 만들고, 정적 팩터리를 제공한다.
3. 모든 필드를 final로 선언한다.
4. 모든 필드를 private로 선언한다.
5. 자신 외에는 내부의 가변 컴포넌트에 접근할 수 없도록 한다. 

#### 불변 객체의 장점

1. 근본적으로 스레드에 안전하다.
   - 불변 객체는 안심하고 공유가 가능하다.
2. 한 번 만든 인스턴스는 최대한 재활용이 가능하다.
3. 불변 객체는 자유롭게 공유할 수 있으면서, 불변 객체끼리 내부 데이터를 공유할 수 있다.
4. 객체를 만들 때 다른 불변 객체들을 구성요소로 사용하면 이점이 많다.
5. 불변 객체는 그 자체로 실패 원자성을 제공한다.
   - 실패 원자성 : 메서드에서 예외가 발생한 후에도 그 객체는 메서드 호출 전 상태와 같은 유효한 상태를 가진다.

#### 불변 객체의 단점

1. 값이 다르면 반드시 독립된 객체로 만들어야 한다.
   - 값이 다를 때마다 새로운 객체를 만들어야 한다.
2. 값의 가짓수가 많다면, 이들을 모두 만드는데 큰 비용을 치러야 한다.

#### 불변 클래스를 만드는 방법

1. 클래스를 final로 선언한다.
2. 모든 생성자를 private 혹은 package-private으로 만들고 public 정적 팩터리를 제공한다.

#### 정리

- 클래스는 꼭 필요한 경우가 아니면 불변이어야 한다.
- 무거운 값 객체의 경우 성능 때문에 어쩔 수 없다면, 불변 클래스와 쌍을 이루는 가변 동반 클래스를 public 클래스로 제공하자.
- 불변으로 만들 수 없는 클래스라도 변경할 수 있는 부분을 최소한으로 줄이자.
- 다른 합당한 이유가 없다면 모든 필드는 private final이어야 한다.
- 생성자는 불변식 설정이 모두 완료된, 초기화가 완벽히 끝난 상태의 객체를 생성해야 한다.





